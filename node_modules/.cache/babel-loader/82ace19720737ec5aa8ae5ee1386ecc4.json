{"remainingRequest":"D:\\Kevin\\Universidad\\CursosUdemy-Platzi\\zebrand_project\\zebrand_frontend_web\\zebrandweb\\node_modules\\babel-loader\\lib\\index.js!D:\\Kevin\\Universidad\\CursosUdemy-Platzi\\zebrand_project\\zebrand_frontend_web\\zebrandweb\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\Kevin\\Universidad\\CursosUdemy-Platzi\\zebrand_project\\zebrand_frontend_web\\zebrandweb\\src\\services\\config.service.js","dependencies":[{"path":"D:\\Kevin\\Universidad\\CursosUdemy-Platzi\\zebrand_project\\zebrand_frontend_web\\zebrandweb\\src\\services\\config.service.js","mtime":1659985164478},{"path":"D:\\Kevin\\Universidad\\CursosUdemy-Platzi\\zebrand_project\\zebrand_frontend_web\\zebrandweb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660005951608},{"path":"D:\\Kevin\\Universidad\\CursosUdemy-Platzi\\zebrand_project\\zebrand_frontend_web\\zebrandweb\\node_modules\\babel-loader\\lib\\index.js","mtime":1660005962392},{"path":"D:\\Kevin\\Universidad\\CursosUdemy-Platzi\\zebrand_project\\zebrand_frontend_web\\zebrandweb\\node_modules\\eslint-loader\\index.js","mtime":1660005950964}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkQ6L0tldmluL1VuaXZlcnNpZGFkL0N1cnNvc1VkZW15LVBsYXR6aS96ZWJyYW5kX3Byb2plY3QvemVicmFuZF9mcm9udGVuZF93ZWIvemVicmFuZHdlYi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLmpzIjsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHsgYXBpVXJsIH0gZnJvbSAnLi4vY29uZmlnL2NvbmZpZyc7CmltcG9ydCB7IHRva2VuTGliIH0gZnJvbSAnLi4vbGliL3Rva2VuLmxpYic7CmF4aW9zLmludGVyY2VwdG9ycy5yZXF1ZXN0LnVzZShmdW5jdGlvbiAoY29uZmlnKSB7CiAgdmFyIHRva2VuID0gdG9rZW5MaWIuZ2V0VG9rZW4oKTsKCiAgaWYgKHRva2VuICYmIGNvbmZpZy51cmwgIT0gIiIuY29uY2F0KGFwaVVybCwgIm9hdXRoL3Rva2VuIikpIHsKICAgIGNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSAiQmVhcmVyICIuY29uY2F0KHRva2VuKTsKICB9CgogIGNvbnNvbGUubG9nKGNvbmZpZyk7CiAgcmV0dXJuIGNvbmZpZzsKfSwgZnVuY3Rpb24gKGVycikgewogIHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpOwp9KTsKYXhpb3MuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICByZXR1cm4gcmVzcG9uc2U7Cn0sIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoZXJyb3IpIHsKICAgIHZhciBvcmlnaW5hbFJlcXVlc3QsIHRva2VuX3JlZnJlc2gsIHBhcmFtcywgZGF0YTsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgb3JpZ2luYWxSZXF1ZXN0ID0gZXJyb3IuY29uZmlnOwogICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTsKCiAgICAgICAgICAgIGlmICghKGVycm9yLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxICYmICFvcmlnaW5hbFJlcXVlc3QuX3JldHJ5KSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNjsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgb3JpZ2luYWxSZXF1ZXN0Ll9yZXRyeSA9IHRydWU7CiAgICAgICAgICAgIHRva2VuX3JlZnJlc2ggPSB0b2tlbkxpYi5nZXRSZWZyZWhUb2tlbigpOwogICAgICAgICAgICBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7CiAgICAgICAgICAgIHBhcmFtcy5hcHBlbmQoJ3JlZnJlc2hfdG9rZW4nLCB0b2tlbl9yZWZyZXNoKTsKICAgICAgICAgICAgcGFyYW1zLmFwcGVuZCgnZ3JhbnRfdHlwZScsICdyZWZyZXNoX3Rva2VuJyk7CiAgICAgICAgICAgIHRva2VuTGliLnJlbW92ZVRva2VucygpOwoKICAgICAgICAgICAgaWYgKCEodG9rZW5fcmVmcmVzaCAhPSBudWxsIHx8IHRva2VuX3JlZnJlc2ggIT0gdW5kZWZpbmVkKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMjsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEyOwogICAgICAgICAgICByZXR1cm4gYXhpb3MoewogICAgICAgICAgICAgIHVybDogIiIuY29uY2F0KGFwaVVybCwgIm9hdXRoL3Rva2VuIiksCiAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXMsCiAgICAgICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD11dGYtOCcsCiAgICAgICAgICAgICAgICAiQXV0aG9yaXphdGlvbiI6ICdCYXNpYyBZMjkyYVdReE9YQnliM2xsWTNRNlkyOTJhV1F4T1hCeWIzbGxZM1F4TWpNME5RPT0nCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICBkYXRhID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgIGlmICghKGRhdGEuc3RhdHVzID09IDIwMCkpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTg7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRva2VuTGliLnNldFRva2VucyhkYXRhLmRhdGEuYWNjZXNzX3Rva2VuLCBkYXRhLmRhdGEucmVmcmVzaF90b2tlbik7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIGF4aW9zKG9yaWdpbmFsUmVxdWVzdCkpOwoKICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBQcm9taXNlLnJlamVjdChlcnJvcikpOwoKICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNDsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIFByb21pc2UucmVqZWN0KGVycm9yKSk7CgogICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDMwOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDI2OgogICAgICAgICAgICBpZiAoIW9yaWdpbmFsUmVxdWVzdC5fcmV0cnkpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzA7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRva2VuTGliLnJlbW92ZVRva2VucygpOwogICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgUHJvbWlzZS5yZWplY3QoZXJyb3IpKTsKCiAgICAgICAgICBjYXNlIDMwOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBQcm9taXNlLnJlamVjdChlcnJvcikpOwoKICAgICAgICAgIGNhc2UgMzM6CiAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAzMzsKICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgxKTsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgUHJvbWlzZS5yZWplY3QoZXJyb3IpKTsKCiAgICAgICAgICBjYXNlIDM2OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMSwgMzNdXSk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gKF94KSB7CiAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKSk7"},{"version":3,"sources":["D:/Kevin/Universidad/CursosUdemy-Platzi/zebrand_project/zebrand_frontend_web/zebrandweb/src/services/config.service.js"],"names":["axios","apiUrl","tokenLib","interceptors","request","use","config","token","getToken","url","headers","Authorization","console","log","err","Promise","reject","response","error","originalRequest","status","_retry","token_refresh","getRefrehToken","params","URLSearchParams","append","removeTokens","undefined","method","data","setTokens","access_token","refresh_token","location","reload"],"mappings":";;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAAQC,MAAR,QAAqB,kBAArB;AACA,SAAQC,QAAR,QAAuB,kBAAvB;AAEAF,KAAK,CAACG,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,CAA+B,UAAUC,MAAV,EAAkB;AAC7C,MAAMC,KAAK,GAAGL,QAAQ,CAACM,QAAT,EAAd;;AACA,MAAID,KAAK,IAAID,MAAM,CAACG,GAAP,cAAiBR,MAAjB,gBAAb,EAAmD;AAC/CK,IAAAA,MAAM,CAACI,OAAP,CAAeC,aAAf,oBAAyCJ,KAAzC;AACH;;AACDK,EAAAA,OAAO,CAACC,GAAR,CAAYP,MAAZ;AACA,SAAOA,MAAP;AACH,CAPD,EAOG,UAAUQ,GAAV,EAAe;AACd,SAAOC,OAAO,CAACC,MAAR,CAAeF,GAAf,CAAP;AACH,CATD;AAUAd,KAAK,CAACG,YAAN,CAAmBc,QAAnB,CAA4BZ,GAA5B,CAAgC,UAACY,QAAD,EAAc;AAC1C,SAAOA,QAAP;AACH,CAFD;AAAA,qEAEG,iBAAgBC,KAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AACOC,YAAAA,eADP,GACyBD,KAAK,CAACZ,MAD/B;AAAA;;AAAA,kBAGSY,KAAK,CAACD,QAAN,CAAeG,MAAf,KAA0B,GAA1B,IAAiC,CAACD,eAAe,CAACE,MAH3D;AAAA;AAAA;AAAA;;AAISF,YAAAA,eAAe,CAACE,MAAhB,GAAyB,IAAzB;AACMC,YAAAA,aALf,GAK+BpB,QAAQ,CAACqB,cAAT,EAL/B;AAMeC,YAAAA,MANf,GAMwB,IAAIC,eAAJ,EANxB;AAOSD,YAAAA,MAAM,CAACE,MAAP,CAAc,eAAd,EAA+BJ,aAA/B;AACAE,YAAAA,MAAM,CAACE,MAAP,CAAc,YAAd,EAA4B,eAA5B;AACAxB,YAAAA,QAAQ,CAACyB,YAAT;;AATT,kBAUaL,aAAa,IAAI,IAAjB,IAAyBA,aAAa,IAAIM,SAVvD;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAW8B5B,KAAK,CAAC;AACnBS,cAAAA,GAAG,YAAKR,MAAL,gBADgB;AAEnBuB,cAAAA,MAAM,EAAEA,MAFW;AAGnBK,cAAAA,MAAM,EAAE,MAHW;AAInBnB,cAAAA,OAAO,EAAE;AACL,gCAAgB,iDADX;AAEL,iCAAiB;AAFZ;AAJU,aAAD,CAXnC;;AAAA;AAWiBoB,YAAAA,IAXjB;;AAAA,kBAqBiBA,IAAI,CAACV,MAAL,IAAe,GArBhC;AAAA;AAAA;AAAA;;AAsBiBlB,YAAAA,QAAQ,CAAC6B,SAAT,CAAmBD,IAAI,CAACA,IAAL,CAAUE,YAA7B,EAA2CF,IAAI,CAACA,IAAL,CAAUG,aAArD;AAtBjB,6CAuBwBjC,KAAK,CAACmB,eAAD,CAvB7B;;AAAA;AAyBiBe,YAAAA,QAAQ,CAACC,MAAT;AAzBjB,6CA0BwBpB,OAAO,CAACC,MAAR,CAAeE,KAAf,CA1BxB;;AAAA;AAAA;AAAA;;AAAA;AA6BagB,YAAAA,QAAQ,CAACC,MAAT;AA7Bb,6CA8BoBpB,OAAO,CAACC,MAAR,CAAeE,KAAf,CA9BpB;;AAAA;AAAA;AAAA;;AAAA;AAAA,iBAiCgBC,eAAe,CAACE,MAjChC;AAAA;AAAA;AAAA;;AAkCSnB,YAAAA,QAAQ,CAACyB,YAAT;AACAO,YAAAA,QAAQ,CAACC,MAAT;AAnCT,6CAoCgBpB,OAAO,CAACC,MAAR,CAAeE,KAAf,CApChB;;AAAA;AAAA,6CAuCYH,OAAO,CAACC,MAAR,CAAeE,KAAf,CAvCZ;;AAAA;AAAA;AAAA;AAAA,6CA0CYH,OAAO,CAACC,MAAR,CAAeE,KAAf,CA1CZ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAFH;;AAAA;AAAA;AAAA;AAAA","sourcesContent":["import axios from 'axios';\r\nimport {apiUrl} from '../config/config';\r\nimport {tokenLib} from '../lib/token.lib'\r\n\r\naxios.interceptors.request.use(function (config) {\r\n    const token = tokenLib.getToken();\r\n    if (token && config.url != `${apiUrl}oauth/token`) {\r\n        config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    console.log(config);\r\n    return config;\r\n}, function (err) {\r\n    return Promise.reject(err);\r\n});\r\naxios.interceptors.response.use((response) => {\r\n    return response\r\n}, async function (error) {\r\n    const originalRequest = error.config;\r\n    try {\r\n        if (error.response.status === 401 && !originalRequest._retry) {\r\n            originalRequest._retry = true;\r\n            const token_refresh = tokenLib.getRefrehToken()\r\n            const params = new URLSearchParams()\r\n            params.append('refresh_token', token_refresh)\r\n            params.append('grant_type', 'refresh_token')\r\n            tokenLib.removeTokens();\r\n            if (token_refresh != null || token_refresh != undefined) {\r\n                var data = await axios({\r\n                    url: `${apiUrl}oauth/token`,\r\n                    params: params,\r\n                    method: \"POST\",\r\n                    headers: {\r\n                        'content-type': 'application/x-www-form-urlencoded;charset=utf-8',\r\n                        \"Authorization\": 'Basic Y292aWQxOXByb3llY3Q6Y292aWQxOXByb3llY3QxMjM0NQ=='\r\n                    },\r\n\r\n                });\r\n                if (data.status == 200) {\r\n                    tokenLib.setTokens(data.data.access_token, data.data.refresh_token)\r\n                    return axios(originalRequest);\r\n                } else {\r\n                    location.reload();\r\n                    return Promise.reject(error);\r\n                }\r\n            } else {\r\n                location.reload();\r\n                return Promise.reject(error);\r\n            }\r\n\r\n        } else if (originalRequest._retry) {\r\n            tokenLib.removeTokens();\r\n            location.reload();\r\n            return Promise.reject(error);\r\n\r\n        }\r\n        return Promise.reject(error);\r\n\r\n    } catch (e) {\r\n        return Promise.reject(error);\r\n    }\r\n});"]}]}